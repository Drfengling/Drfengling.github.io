
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>C#WCF方向(一) - 浅梦博客</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="WCF开始入手WCF了,从零开始,记录一下WCF的学习笔记
什么是WCF摘要WCF是使用托管代码建立和运行面向服务（Service Oriented）应用程序的统一框架。它使得开发者能够建立一个跨平,"> 
    <meta name="author" content="浅梦风凌"> 
    <link rel="alternative" href="atom.xml" title="浅梦博客" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="C#WCF方向(一) - 浅梦博客"/>
    <meta name="twitter:description" content="WCF开始入手WCF了,从零开始,记录一下WCF的学习笔记
什么是WCF摘要WCF是使用托管代码建立和运行面向服务（Service Oriented）应用程序的统一框架。它使得开发者能够建立一个跨平,"/>
    
    
    
    
    <meta property="og:site_name" content="浅梦博客"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="C#WCF方向(一) - 浅梦博客"/>
    <meta property="og:description" content="WCF开始入手WCF了,从零开始,记录一下WCF的学习笔记
什么是WCF摘要WCF是使用托管代码建立和运行面向服务（Service Oriented）应用程序的统一框架。它使得开发者能够建立一个跨平,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body class="loading">
    <span id="config-title" style="display:none">浅梦博客</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://drfengling.github.io"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">C#WCF方向(一)</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">C#WCF方向(一)</h1>
        <div class="stuff">
            <span>五月 03, 2022</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/WCF/" rel="tag">WCF</a></li></ul>


        </div>
        <div class="content markdown">
            <h2 id="WCF"><a href="#WCF" class="headerlink" title="WCF"></a>WCF</h2><p>开始入手WCF了,从零开始,记录一下WCF的学习笔记</p>
<h3 id="什么是WCF"><a href="#什么是WCF" class="headerlink" title="什么是WCF"></a>什么是WCF</h3><p>摘要<br>WCF是使用托管代码建立和运行面向服务（Service Oriented）应用程序的统一框架。它使得开发者能够建立一个跨平台的安全、可信赖、事务性的解决方案，且能与已有系统兼容协作。WCF是微软分布式应用程序开发的集大成者，它整合了.Net平台下所有的和分布式系统有关的技术，例如.Net Remoting、ASMX、WSE和MSMQ。以通信(Communiation)范围而论，它可以跨进程、跨机器、跨子网、企业网乃至于 Internet；以宿主程序而论，可以以ASP.NET，EXE，WPF，Windows Forms，NT Service，COM+作为宿主(Host)。</p>
<span id="more"></span>
<p>简述<br>1.WCF全称Windows Communication Foundation<br>2.是Miscrosoft为构建面向服务的应用提供的分布式通信编程框架<br>3.是.Net Framework的重要组成部分.<br>4.WCF4.0<br>历史<br>ASMX WSE WCF3.0 WCF3.5 WCF4.0 WCFN.0</p>
<h3 id="集成微软分布式技术"><a href="#集成微软分布式技术" class="headerlink" title="集成微软分布式技术"></a>集成微软分布式技术</h3><p>WCF:WSE. MSMQ.  Enterprise Service COM+ .NET Remoting ASP.NET Web Service</p>
<h3 id="托管方式多样化"><a href="#托管方式多样化" class="headerlink" title="托管方式多样化"></a>托管方式多样化</h3><p>托管(Host)<br>IIS EXE Winform wpf Window Service  NT Service COM+</p>
<h3 id="统一编程模型"><a href="#统一编程模型" class="headerlink" title="统一编程模型"></a>统一编程模型</h3><p>Client Talk to  (Binding,Address,Contract)<br>1.Address: 每一个WCF的Service都有一个唯一的地址。这个地址给出了Service的地址和传输协议(Transport Protocol)。<br>2.Binding:绑定制定了服务通过什么形式访问。只要类比传输协议, encoding (text, binary, etc) 以及 WS-* 协议，像transactional支持以及可信任的消息队列。<br>3.Contract:Contract描述了Service能提供的各种服务。Contract有四种，包括Service Contract, Data Contract, Fault Contract和Message Contract。</p>
<h3 id="WCF知识点"><a href="#WCF知识点" class="headerlink" title="WCF知识点"></a>WCF知识点</h3><p>1.契约 Contract<br>2.宿主 Host<br>3.绑定 Binding<br>4.事务 Transaction<br>5.消息队列 MSMQ<br>6.并发控制 Concurrency Control<br>7.错误处理 Error Handling<br>8.安全 Security<br>9.诊断与调试</p>
<h3 id="软件工程的发展历史"><a href="#软件工程的发展历史" class="headerlink" title="软件工程的发展历史"></a>软件工程的发展历史</h3><p>面向过程PO 面向对象OO 面向组件CO 面向服务SO</p>
<h3 id="SOA的特征"><a href="#SOA的特征" class="headerlink" title="SOA的特征"></a>SOA的特征</h3><p>1.Service Oriented Architecture<br>2.面向服务的架构<br>互操作 重用 松耦合</p>
<h3 id="Web服务类别"><a href="#Web服务类别" class="headerlink" title="Web服务类别"></a>Web服务类别</h3><p>SOAP REST<br>soap:简单对象访问协议<br>rest：轻量级WebApi服务</p>
<h3 id="Web服务使用的领域"><a href="#Web服务使用的领域" class="headerlink" title="Web服务使用的领域"></a>Web服务使用的领域</h3><p>开发中间产品 暴露接口服务 集成第三方系统</p>
<h3 id="应用系统中的Web服务"><a href="#应用系统中的Web服务" class="headerlink" title="应用系统中的Web服务"></a>应用系统中的Web服务</h3><p>表现层<br>服务层<br>业务逻辑层——&gt;  ESB企业服务总线   ——&gt;服务<br>数据访问层<br>数据 数据</p>
<h3 id="系统集成中的Web服务"><a href="#系统集成中的Web服务" class="headerlink" title="系统集成中的Web服务"></a>系统集成中的Web服务</h3><p>   电子商务网站订单系统<br>    |              |                |<br>银行服务 库存系统服务 短信服务</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>1.创建一个WCF服务程序 程序并调用<br>打开Visual Studio开发工具 我这里用的2022<br>左上角菜单 文件 点击新建 选择项目 打开了创建新项目的对话框 我们在搜索栏搜素wcf<br>搜索结果如下所示:<br><img src="/qm/e08ab1e4/1.jpg"><br>这里选择WCF服务应用程序<br><img src="/qm/e08ab1e4/2.jpg"><br>自定义下项目名 位置 这里选用.Net4.5.2框架 创建即可<br><img src="/qm/e08ab1e4/3.jpg"><br>创建完成后 默认会添加IService1.cs,Service1.svc文件,.svc扩展文件,它会做一些消息的路由工作,激活服务,会通过文件做一些处理.<br>IService1.cs<br>ServiceContract:服务契约<br>包含两个操作契约OperationContract：GetData,GetDataUsingDataContract 使用数据契约获取数据<br>DataContract:数据契约:<br>包含两个值 bool  StringValue<br>做下自定义更改<br>1.增加数据契约对象<br>我们在IService1.cs中创建一个类自定义命名我的如下新增一个用户数据对象,增加以下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[DataContract]//数据契约对象</span><br><span class="line">    public class UserData &#123; </span><br><span class="line">        [DataMember]</span><br><span class="line">        public string UserName &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">        [DataMember]</span><br><span class="line">        public string Email &#123; get; <span class="built_in">set</span>; &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>2.增加服务契约接口<br>我们在IService1.cs中interface IService1中新增接口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// TODO: 在此添加您的服务操作</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// 自定义服务契约</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=<span class="string">&quot;user&quot;</span>&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">        [OperationContract]///注意:增加操作契约标记</span><br><span class="line">        UserData GetUserData(UserData user);</span><br></pre></td></tr></table></figure>
<p>3.在Service1.svc中新增实现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">///新增实现</span><br><span class="line">       public UserData GetUserData(UserData user) &#123;</span><br><span class="line">           <span class="built_in">return</span> user;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<p>到此，我们已完成了简单的数据服务实现契约,点击导航栏生成——&gt;重新生成解决方案,确认无报错后执行下一步<br>4.在浏览器中查看<br>点击Service1.svc右键选择在浏览器中查看<br>visual Studio打开浏览器,跳转服务界面.<br><img src="/qm/e08ab1e4/4.jpg"><br>出现这个界面,说明你的服务是正常的.可以发布了.我们看到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">svcutil.exe http://localhost:60217/Service1.svc?wsdl</span><br></pre></td></tr></table></figure>
<p>wsdl:服务描述语言,对外公布的服务语言,你想让别人引用你的服务的话,就可以引用这个.<br>我们可以看到下方有客户端调用示例.后面客户端调用服务可以仿照使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">C<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">class Test</span><br><span class="line">&#123;</span><br><span class="line">    static void <span class="function"><span class="title">Main</span></span>()</span><br><span class="line">    &#123;</span><br><span class="line">        Service1Client client = new Service1Client();</span><br><span class="line"></span><br><span class="line">        // 使用 <span class="string">&quot;client&quot;</span> 变量在服务上调用操作。</span><br><span class="line"></span><br><span class="line">        // 始终关闭客户端。</span><br><span class="line">        client.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Visual Basic</span><br><span class="line"></span><br><span class="line">Class Test</span><br><span class="line">    Shared Sub Main()</span><br><span class="line">        Dim client As Service1Client = New Service1Client()</span><br><span class="line">        <span class="string">&#x27; 使用 &quot;client&quot; 变量在服务上调用操作。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#x27;</span> 始终关闭客户端。</span><br><span class="line">        client.Close()</span><br><span class="line">    End Sub</span><br><span class="line">End Class</span><br></pre></td></tr></table></figure>
<p>5.新增WPF项目<br>我们在解决方案下新增一个WPF项目<br>(也可以新增一个网站项目,Winform项目等)<br><img src="/qm/e08ab1e4/5.jpg"><br>自定义名字WCFClient创建.<br>6.引用服务<br>在创建好的wpf项目中选择引用,右键选择添加服务引用,打开如下:<br><img src="/qm/e08ab1e4/6.jpg"><br>我们输入步骤4在浏览器打开后生成的公共服务语言</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:60217/Service1.svc?wsdl</span><br></pre></td></tr></table></figure>
<p>自定义命名空间名称ServiceReference确定.<br>提示:我们也可以点击发现.发现解决方案中的服务.<br>服务栏会为我们找到对应服务.<br><img src="/qm/e08ab1e4/7.jpg"><br>点击Service1.svc打开到IService1,即可查看右侧列表显示的三个服务接口,两个默认的服务接口契约,<br>和一个我们新增的GetUserData服务契约.(如果没有显示新增的接口,请返回WCF项目检查是否遗漏契约标记)<br>点击添加后的服务引用可以查看<br><img src="/qm/e08ab1e4/8.jpg"><br>7.使用Wpf调用服务</p>
<ul>
<li>打开MainWindow新增Button按钮,可以打开工具栏拖动Button到界面上,或编写Xaml文本增加,完成后调整布局.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Grid HorizontalAlignment=<span class="string">&quot;Center&quot;</span> VerticalAlignment=<span class="string">&quot;Center&quot;</span>&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">            Width=<span class="string">&quot;100&quot;</span></span><br><span class="line">            Height=<span class="string">&quot;30&quot;</span></span><br><span class="line">            Content=<span class="string">&quot;调用服务&quot;</span> Click=<span class="string">&quot;Button_Click&quot;</span>/&gt;</span><br><span class="line">    &lt;/Grid&gt;</span><br></pre></td></tr></table></figure></li>
<li>点击Click事件F12进入后置代码,这里不做复杂框架处理,后置编写点击实现Wcf服务调用<br>具体实现如下:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/// &lt;summary&gt;</span><br><span class="line">        /// 调用WCF服务.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=<span class="string">&quot;sender&quot;</span>&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;param name=<span class="string">&quot;e&quot;</span>&gt;&lt;/param&gt;</span><br><span class="line">        private void Button_Click(object sender, RoutedEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Service1Client client = new Service1Client();</span><br><span class="line">            string result1 = client.GetData(1);</span><br><span class="line">            UserData userData = client.GetUserData(new <span class="function"><span class="title">UserData</span></span>() &#123; Email=<span class="string">&quot;Drfengling@163.com&quot;</span>,UserName=<span class="string">&quot;浅梦风凌&quot;</span>&#125;);</span><br><span class="line">            client.Close();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>8.生成调试服务</p>
<ul>
<li>点击导航栏生成 重新生成解决方案 确认无误后在点击事件处打断点调试</li>
<li>选择WCFClient为启动项目,点击导航栏调试开始调试,点击按钮调用服务,观察服务调用结果<br><img src="/qm/e08ab1e4/9.jpg"><br>可以看到我们在客户端完成了对服务端的调用,调用获取到了WCF服务结果.<br>快来动手试试搭建简单的服务调用吧.</li>
</ul>
<h3 id="WCF的新特性"><a href="#WCF的新特性" class="headerlink" title="WCF的新特性"></a>WCF的新特性</h3><p>WCF4.5新特性<br>1.支持契约优先(Contract First)的开发<br>2.Building发现配置错误<br>3.支持新异步流<br>4.?singleWSDL<br>5.Websockets支持在端口80和443<br>6.XML编辑器工具展示<br>7.ChannelFactory缓存支持<br>8.二进制编码器压缩支持<br>9.不管Fire and foget的UDP消息发交换模式<br>10.支持单个WCF终结点支持多个身份验证模式<br>11.支持WCF服务使用国际化域名（IDNs）</p>
<h3 id="WCF学习资源"><a href="#WCF学习资源" class="headerlink" title="WCF学习资源"></a>WCF学习资源</h3><p>1.最权威WCF书籍</p>
<ul>
<li>Programing WCF Service,(Juval Lowy)</li>
<li>《WCF服务编程》第三版</li>
<li>Inside WCF,(Justin Smith)</li>
<li>《WCF技术内幕》</li>
</ul>
<p>2.论坛</p>
<ul>
<li>微软WCF中文技术论坛<br><a target="_blank" rel="noopener" href="http://social.msdn.microsoft.com/Forums/zh-CN/wcfzhchs/threads">http://social.msdn.microsoft.com/Forums/zh-CN/wcfzhchs/threads</a></li>
<li>微软WCF英文技术论坛</li>
<li>跟我一起从零开始学WCF系列课程(由于官网视频已经失效了,有兴趣可以看看这篇博客)<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dqj1024/archive/2012/07/21/2602342.html">https://www.cnblogs.com/dqj1024/archive/2012/07/21/2602342.html</a></li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
